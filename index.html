<h2>Job Dashboard</h2>
<a href="create.html">Add Job</a>

<table border="1">
<thead>
<tr>
<th>Title</th><th>Type</th><th>Status</th><th>Apps</th><th>Action</th>
</tr>
</thead>
<tbody id="jobs"></tbody>
</table>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

<script>
fetch('http://127.0.0.1:8000/api/jobs')
.then(res => res.json())
.then(data => {
  let html = '';
  data.forEach(j => {
    html += `
    <tr>
      <td>${j.title}</td>
      <td>${j.type}</td>
      <td>${j.status}</td>
      <td>${j.applications}</td>
      <td>
        <a href="edit.html?id=${j.id}">Edit</a>
        <button onclick="deleteJob(${j.id})">Delete</button>
      </td>
    </tr>`;
  });
  document.getElementById('jobs').innerHTML = html;
});

const apiUrl = 'http://localhost/job-dashboard-backend/public/api/jobs';

function deleteJob(id){
  if(confirm("Are you sure you want to delete this job?")) {
    fetch(`${apiUrl}/${id}`, { method:'DELETE' })
    .then(res => res.json())
    .then(data => {
        alert(data.message); 
        location.reload();
    })
    .catch(err => console.log(err));
  }
}
</script>
